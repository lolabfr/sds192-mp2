---
title: "Mini-Project 2"
author: "Beth Campbell, Lola Roberts and Felicia Villalobos"
date: "March 22, 2018"
output:
  html_document:
    code_folding: hide
---
```{r, message=FALSE, warning=FALSE}
library(tidyverse)
library(ggplot2)
```

```{r, message=FALSE, warning=FALSE}
load("house_elections.rda")
load("candidates.rda")
load("committees.rda")
load("contributions.rda")
```

```{r, message=FALSE, warning=FALSE}
# #join comtributions and candidates (both have cand_id)
# #now will have cand name, org, transaction amount $
# #then filter out the negative transation amounts 
# 
# test1 <- contributions %>%
#   filter(transaction_amt > 0) %>%
#   select(cand_id, transaction_amt, tran_id)
#   
# test2 <- candidates %>%
#   select(cand_id, cand_name, cand_election_yr, cand_party_affiliation)
# 
# comfilter <- committees %>%
#   select(cand_id, cmte_name, cmte_type)
```

```{r, message=FALSE, warning=FALSE}
#trying to join the above stuff 

# newthing <- test1 %>%
#   inner_join(test2, by = "cand_id")

#newerthing <- comfilter %>% 
 # filter(cand_id as NA) %>%
  #will have all contributions that went to candidate committee
  #inner_join(newthing, by = "cand_id")
```

```{r, message=FALSE, warning=FALSE}
# what we want from candidates
candFilter <- candidates %>%
  select(cand_id, cand_name, cand_party_affiliation, cand_state)

# what we want from contributions
contrFilter <- contributions %>%
  select(cmte_id, name, state, transaction_amt, cand_id)

#joining contributions and candidates
canCon <- candFilter %>%
  full_join(contrFilter, candFilter, by = "cand_id")

# organizing canCon to show what we want
# this is the new data set that has no na's in the cand_name slot 
canCon <- canCon %>%
  filter(!is.na(cand_name),
         !is.na(cmte_id),
         !is.na(name),
         !is.na(state),
         !is.na(transaction_amt),
         transaction_amt > 0) %>%
  group_by(cand_name, cand_state) %>%
  summarize(totalContributionCandidate = sum(transaction_amt)) %>%
  arrange(desc(totalContributionCandidate)) %>%
  head(10)

#View(canCon2)
```

This data may be misleading because we have summed all of the money spent candidates without a distinction of whether the contribution was for or against them. We found the total amount of money spent on each candidate by joining together the candidates dataset and contributions dataset (full_join). Before joining we selected columns from each dataset with relevant information and to speed up the joining process as to not overload the RStudio system. Once we joined them, we filtered out all of the information with NA to make our dataset more clear and easier to understand, from there we grouped by candidate name and state so that we could see the total amount they received. We proceeded to see the candidates that got the largest amount of contributions first by arranging in descending order, our dataset only shows the top ten to make a more readable graph.  

```{r, message=FALSE, warning=FALSE}
candVs.Money <- ggplot(canCon, aes(x = cand_name, y = totalContributionCandidate, fill = cand_state)) + 
geom_bar(stat = "identity")

candVs.Money
```


